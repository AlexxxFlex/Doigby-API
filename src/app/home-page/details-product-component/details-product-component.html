@if (product) {
  <div class="product-details-container">
    <button class="back-button" (click)="goBack()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
      Retour
    </button>

    <div class="product-details-content">
      <div class="product-gallery">
        <div class="main-image">
          <img [src]="selectedImage" [alt]="product.name" />
          @if (!isAvailable()) {
            <span class="out-of-stock-badge">Rupture de stock</span>
          }
        </div>
        
        @if (product.images && product.images.length > 1) {
          <div class="thumbnail-gallery">
            @for (image of product.images; track image) {
              <img 
                [src]="image" 
                [alt]="product.name"
                [class.active]="selectedImage === image"
                (click)="selectImage(image)"
              />
            }
          </div>
        }
      </div>

      <div class="product-info-section">
        <p class="product-category">{{ product.category.name }}</p>
        <h1 class="product-title">{{ product.name }}</h1>
        <p class="product-price">{{ product.basePrice | currency:'EUR':'symbol':'1.2-2':'fr-FR' }}</p>
        
        <div class="stock-info">
          @if (isAvailable()) {
            <span class="in-stock">
              ✓ En stock ({{ product.stock }} disponibles)
            </span>
          } @else {
            <span class="out-of-stock">
              ✗ Rupture de stock
            </span>
          }
        </div>

        <p class="product-description">{{ product.description }}</p>

        <div class="product-options">
          @if (product.sizes && product.sizes.length > 0) {
            <div class="option-group">
              <label>Taille:</label>
              <div class="size-selector">
                @for (size of product.sizes; track size) {
                  <button 
                    [class.selected]="selectedSize === size"
                    (click)="selectedSize = size"
                    class="size-option">
                    {{ size }}
                  </button>
                }
              </div>
            </div>
          }

          @if (product.colors && product.colors.length > 0) {
            <div class="option-group">
              <label>Couleur:</label>
              <div class="color-selector">
                @for (color of product.colors; track color) {
                  <button 
                    [class.selected]="selectedColor === color"
                    (click)="selectColor(color)"
                    class="color-option"
                    [title]="color">
                    {{ color }}
                  </button>
                }
              </div>
            </div>
          }

          <div class="option-group">
            <label>Quantité:</label>
            <div class="quantity-selector">
              <button (click)="decrementQuantity()" [disabled]="quantity <= 1">-</button>
              <span>{{ quantity }}</span>
              <button (click)="incrementQuantity()" [disabled]="quantity >= product.stock">+</button>
            </div>
          </div>
        </div>

        <button 
          class="add-to-cart-button" 
          [disabled]="!isAvailable()"
          (click)="addToCart()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          {{ isAvailable() ? 'Ajouter au panier' : 'Indisponible' }}
        </button>
      </div>
    </div>
  </div>
}